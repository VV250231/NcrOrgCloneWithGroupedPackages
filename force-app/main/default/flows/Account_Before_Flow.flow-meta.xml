<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>55.0</apiVersion>
    <assignments>
        <name>Populate_Data_Source_Code_Source_Name_and_Interface_Source_as_CDM</name>
        <label>Populate Data Source Code Source Name and Interface Source as CDM</label>
        <locationX>413</locationX>
        <locationY>767</locationY>
        <assignmentItems>
            <assignToReference>$Record.Interface_Source__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>VariableCDM</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.MDM_Data_Source_Code__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>VariableCDM</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.MDM_Data_Source_Name__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>VariableCDM</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Active_Account_Field</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Account_Record_Type_As_Partner1</name>
        <label>Set Account Record Type As Partner</label>
        <locationX>677</locationX>
        <locationY>1775</locationY>
        <assignmentItems>
            <assignToReference>$Record.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>0127000000014kqAAA</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Active_Inactive_Account_Date_Stamp</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Account_Record_Type_As_Site</name>
        <label>Set Account Record Type As Site</label>
        <locationX>413</locationX>
        <locationY>1775</locationY>
        <assignmentItems>
            <assignToReference>$Record.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>0124u000000l5NkAAI</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Active_Inactive_Account_Date_Stamp</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Account_Type_as_Customer</name>
        <label>Set Account Record Type as Customer</label>
        <locationX>149</locationX>
        <locationY>1775</locationY>
        <assignmentItems>
            <assignToReference>$Record.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>0127000000011t5AAA</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Active_Inactive_Account_Date_Stamp</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Active_Account_To_Flase</name>
        <label>Set Active Account To Flase</label>
        <locationX>545</locationX>
        <locationY>1103</locationY>
        <assignmentItems>
            <assignToReference>$Record.Active_Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Account_has_mcn_and_country_code</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Active_Account_To_True</name>
        <label>Set Active Account To True</label>
        <locationX>281</locationX>
        <locationY>1103</locationY>
        <assignmentItems>
            <assignToReference>$Record.Active_Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Account_has_mcn_and_country_code</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_Account_Active_Date</name>
        <label>Update Account Active Date</label>
        <locationX>281</locationX>
        <locationY>2111</locationY>
        <assignmentItems>
            <assignToReference>$Record.Account_Active_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_account_record_type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_account_inactive_date_field</name>
        <label>Update account inactive date field</label>
        <locationX>545</locationX>
        <locationY>2111</locationY>
        <assignmentItems>
            <assignToReference>$Record.Account_Inactive_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_account_record_type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Enterprise records should be owned by admin.</description>
        <name>Update_account_owner</name>
        <label>Update account owner</label>
        <locationX>50</locationX>
        <locationY>2687</locationY>
        <assignmentItems>
            <assignToReference>$Record.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_NSC_admin_user_detail.Id</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Update_field_country_with_Master_customer_Number</name>
        <label>Update  field country with Master customer Number</label>
        <locationX>413</locationX>
        <locationY>1439</locationY>
        <assignmentItems>
            <assignToReference>$Record.Country_with_Master_customer_Number__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CountrywithMastercustomerNumber</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_Account_Type1</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Update Previous Name field on Account with Previous Account Name when Account Name updated.</description>
        <name>Update_Previous_Name</name>
        <label>Update Previous Name</label>
        <locationX>413</locationX>
        <locationY>431</locationY>
        <assignmentItems>
            <assignToReference>$Record.Previous_Name__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record__Prior.Name</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Account_Source</targetReference>
        </connector>
    </assignments>
    <decisions>
        <description>Country code with Master Customer Number makes unique value for each customer in Account .</description>
        <name>Account_has_mcn_and_country_code</name>
        <label>Account has mcn and country code</label>
        <locationX>545</locationX>
        <locationY>1319</locationY>
        <defaultConnector>
            <targetReference>Check_Account_Type1</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Else</defaultConnectorLabel>
        <rules>
            <name>Populate_Counrty_with_Master_Customer_Number</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Account_Country_Code__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Master_Customer_Number__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_field_country_with_Master_customer_Number</targetReference>
            </connector>
            <label>Populate Counrty with Master Customer Number</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checking value of account record type.</description>
        <name>Check_account_record_type</name>
        <label>Check account record type</label>
        <locationX>545</locationX>
        <locationY>2327</locationY>
        <defaultConnectorLabel>Else</defaultConnectorLabel>
        <rules>
            <name>If_Enterprise</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Enterprise</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Created_or_Updated</targetReference>
            </connector>
            <label>If Enterprise</label>
        </rules>
    </decisions>
    <decisions>
        <description>We are getting Account Type from CDM via SOUP. Based on Account Type we will set up Account Record Type.</description>
        <name>Check_Account_Type1</name>
        <label>Check Account Type</label>
        <locationX>545</locationX>
        <locationY>1655</locationY>
        <defaultConnector>
            <targetReference>Update_Active_Inactive_Account_Date_Stamp</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Set_Account_Record_Type</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>END CUSTOMER</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Account_Type_as_Customer</targetReference>
            </connector>
            <label>Set Account Record Type As Customer</label>
        </rules>
        <rules>
            <name>Set_Account_Record_Type_As_Site2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Site</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Account_Record_Type_As_Site</targetReference>
            </connector>
            <label>Set Account Record Type As Site</label>
        </rules>
        <rules>
            <name>Set_Account_Record_Type_As_Partner</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>PARTNER</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>DISTRIBUTOR</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>INTERNAL</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>LOCAL OFFICE</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Account_Record_Type_As_Partner1</targetReference>
            </connector>
            <label>Set Account Record Type As Partner</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checking the value of account name field.</description>
        <name>Check_if_account_name_is_changed</name>
        <label>Check if account name is changed</label>
        <locationX>545</locationX>
        <locationY>311</locationY>
        <defaultConnector>
            <targetReference>Update_Account_Source</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Else</defaultConnectorLabel>
        <rules>
            <name>Is_account_name_changed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Name</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.Name</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Previous_Name</targetReference>
            </connector>
            <label>Is account name changed?</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checking account owner value is it updated or not.</description>
        <name>Check_owner_Id_updated</name>
        <label>Check owner Id updated</label>
        <locationX>446</locationX>
        <locationY>2567</locationY>
        <defaultConnectorLabel>Else</defaultConnectorLabel>
        <rules>
            <name>If_account_owner_updated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.OwnerId</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record.OwnerId</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>Get_NSC_admin_user_detail</targetReference>
            </connector>
            <label>If account owner updated</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checking the record is created or updated.</description>
        <name>Is_Created_or_Updated</name>
        <label>Is Created or Updated</label>
        <locationX>248</locationX>
        <locationY>2447</locationY>
        <defaultConnector>
            <targetReference>Check_owner_Id_updated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Else</defaultConnectorLabel>
        <rules>
            <name>If_Created</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_NSC_admin_user_detail</targetReference>
            </connector>
            <label>If Created</label>
        </rules>
    </decisions>
    <decisions>
        <name>Update_Account_Source</name>
        <label>Update Account Source</label>
        <locationX>545</locationX>
        <locationY>647</locationY>
        <defaultConnector>
            <targetReference>Update_Active_Account_Field</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Else</defaultConnectorLabel>
        <rules>
            <name>Account_Source_Update</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Account_CDM_ID__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue></stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.MDM_Data_Source_Code__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>VariableCDM</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Populate_Data_Source_Code_Source_Name_and_Interface_Source_as_CDM</targetReference>
            </connector>
            <label>Account Source Update</label>
        </rules>
    </decisions>
    <decisions>
        <description>The Active checkbox on account is set to True/Flase based on the following conditions.</description>
        <name>Update_Active_Account_Field</name>
        <label>Update Active Account Field</label>
        <locationX>545</locationX>
        <locationY>983</locationY>
        <defaultConnector>
            <targetReference>Account_has_mcn_and_country_code</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Else</defaultConnectorLabel>
        <rules>
            <name>Update_Active_Account</name>
            <conditionLogic>((1 OR 2 OR 3) AND 4) AND 5 AND 6 AND 7</conditionLogic>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>ActiveVariable</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>VariableTarget</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>VariableERPReady</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue></stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CDM_IsMerged__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.MDM_Data_Source_Code__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>VariableCDM</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Active_Account__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Active_Account_To_True</targetReference>
            </connector>
            <label>Update Active Account</label>
        </rules>
        <rules>
            <name>Update_Inactive_Account</name>
            <conditionLogic>((1 AND 2 AND 3) OR 4) AND 5 AND 6</conditionLogic>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>ActiveVariable</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>VariableTarget</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CDM_Account_Status__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>VariableERPReady</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CDM_IsMerged__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.MDM_Data_Source_Code__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>VariableCDM</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Active_Account__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Active_Account_To_Flase</targetReference>
            </connector>
            <label>Update Inactive Account</label>
        </rules>
    </decisions>
    <decisions>
        <description>The field Active Account Date and Inactive Account Date are set whenever there is change in Active Checkbox.</description>
        <name>Update_Active_Inactive_Account_Date_Stamp</name>
        <label>Update Active/Inactive Account Date Stamp</label>
        <locationX>545</locationX>
        <locationY>1991</locationY>
        <defaultConnector>
            <targetReference>Check_account_record_type</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Else</defaultConnectorLabel>
        <rules>
            <name>Is_Active_Account_changed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>AccountActiveDate</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Account_Active_Date</targetReference>
            </connector>
            <label>Is Active Account changed</label>
        </rules>
        <rules>
            <name>Is_Active_Account_changes_to_false</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>AccountInactiveDate</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_account_inactive_date_field</targetReference>
            </connector>
            <label>Is Active Account changes to false</label>
        </rules>
    </decisions>
    <description>This flow will run before insert and before update on the account object.
Following workflow has been migrated to this flow:
1. Previous Name
2. Enterprise records should be owned by admin</description>
    <environments>Default</environments>
    <formulas>
        <name>AccountActiveDate</name>
        <dataType>Boolean</dataType>
        <expression>((ISNEW() || ISCHANGED($Record.Active_Account__c)) &amp;&amp; $Record.Active_Account__c)</expression>
    </formulas>
    <formulas>
        <name>AccountInactiveDate</name>
        <dataType>Boolean</dataType>
        <expression>((ISNEW() || ISCHANGED($Record.Active_Account__c)) &amp;&amp;  !($Record.Active_Account__c))</expression>
    </formulas>
    <formulas>
        <description>Field - Country with Master customer Number will be the formula field containing Account Country Code and MCN</description>
        <name>CountrywithMastercustomerNumber</name>
        <dataType>String</dataType>
        <expression>TEXT({!$Record.Account_Country_Code__c})+{!$Record.Master_Customer_Number__c}</expression>
    </formulas>
    <interviewLabel>Account Before Flow {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Account Before Flow</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <description>Fetching NSC admin user information.</description>
        <name>Get_NSC_admin_user_detail</name>
        <label>Get NSC admin user detail</label>
        <locationX>50</locationX>
        <locationY>2567</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Update_account_owner</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Quicklook_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Label.NSC_ADMIN_QUICKLOOK_ID</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>419</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Check_if_account_name_is_changed</targetReference>
        </connector>
        <filterFormula>NOT({!$Setup.Automation_Setting__c.Skip_Flow__c})</filterFormula>
        <object>Account</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordBeforeSave</triggerType>
    </start>
    <status>Active</status>
    <variables>
        <name>ActiveVariable</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Active</stringValue>
        </value>
    </variables>
    <variables>
        <name>VariableCDM</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>CDM</stringValue>
        </value>
    </variables>
    <variables>
        <name>VariableERPReady</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>ERP Ready</stringValue>
        </value>
    </variables>
    <variables>
        <name>VariableTarget</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Target</stringValue>
        </value>
    </variables>
</Flow>
